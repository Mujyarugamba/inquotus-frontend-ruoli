{"ast":null,"code":"import{supabase}from'../config/supabaseClient';const MAX_SIZE_MB=3;const ALLOWED_TYPES=['image/jpeg','image/png'];const useUploadImmagine=()=>{const upload=async(file,emailUtente)=>{if(!file||!emailUtente)return{url:'',error:'File o utente non valido.'};// Validazione formato\nif(!ALLOWED_TYPES.includes(file.type)){return{url:'',error:'Formato non supportato. Usa JPEG o PNG.'};}// Validazione dimensione\nconst maxBytes=MAX_SIZE_MB*1024*1024;if(file.size>maxBytes){return{url:'',error:`Il file supera i ${MAX_SIZE_MB}MB.`};}const timestamp=Date.now();const fileName=`${emailUtente}/${timestamp}-${file.name}`;const{data,error}=await supabase.storage.from('richieste').upload(fileName,file,{cacheControl:'3600',upsert:true});if(error){console.error('Errore upload immagine:',error);return{url:'',error:'Errore durante l\\'upload.'};}const{data:publicUrlData}=supabase.storage.from('richieste').getPublicUrl(fileName);return{url:(publicUrlData===null||publicUrlData===void 0?void 0:publicUrlData.publicUrl)||'',error:null};};return{upload};};export default useUploadImmagine;","map":{"version":3,"names":["supabase","MAX_SIZE_MB","ALLOWED_TYPES","useUploadImmagine","upload","file","emailUtente","url","error","includes","type","maxBytes","size","timestamp","Date","now","fileName","name","data","storage","from","cacheControl","upsert","console","publicUrlData","getPublicUrl","publicUrl"],"sources":["C:/Users/151702/Desktop/Inquotus/Inquotus-frontend-ruoli/src/hooks/useUploadImmagine.js"],"sourcesContent":["import { supabase } from '../config/supabaseClient';\n\nconst MAX_SIZE_MB = 3;\nconst ALLOWED_TYPES = ['image/jpeg', 'image/png'];\n\nconst useUploadImmagine = () => {\n  const upload = async (file, emailUtente) => {\n    if (!file || !emailUtente) return { url: '', error: 'File o utente non valido.' };\n\n    // Validazione formato\n    if (!ALLOWED_TYPES.includes(file.type)) {\n      return { url: '', error: 'Formato non supportato. Usa JPEG o PNG.' };\n    }\n\n    // Validazione dimensione\n    const maxBytes = MAX_SIZE_MB * 1024 * 1024;\n    if (file.size > maxBytes) {\n      return { url: '', error: `Il file supera i ${MAX_SIZE_MB}MB.` };\n    }\n\n    const timestamp = Date.now();\n    const fileName = `${emailUtente}/${timestamp}-${file.name}`;\n\n    const { data, error } = await supabase.storage\n      .from('richieste')\n      .upload(fileName, file, {\n        cacheControl: '3600',\n        upsert: true,\n      });\n\n    if (error) {\n      console.error('Errore upload immagine:', error);\n      return { url: '', error: 'Errore durante l\\'upload.' };\n    }\n\n    const { data: publicUrlData } = supabase\n      .storage\n      .from('richieste')\n      .getPublicUrl(fileName);\n\n    return { url: publicUrlData?.publicUrl || '', error: null };\n  };\n\n  return { upload };\n};\n\nexport default useUploadImmagine;\n"],"mappings":"AAAA,OAASA,QAAQ,KAAQ,0BAA0B,CAEnD,KAAM,CAAAC,WAAW,CAAG,CAAC,CACrB,KAAM,CAAAC,aAAa,CAAG,CAAC,YAAY,CAAE,WAAW,CAAC,CAEjD,KAAM,CAAAC,iBAAiB,CAAGA,CAAA,GAAM,CAC9B,KAAM,CAAAC,MAAM,CAAG,KAAAA,CAAOC,IAAI,CAAEC,WAAW,GAAK,CAC1C,GAAI,CAACD,IAAI,EAAI,CAACC,WAAW,CAAE,MAAO,CAAEC,GAAG,CAAE,EAAE,CAAEC,KAAK,CAAE,2BAA4B,CAAC,CAEjF;AACA,GAAI,CAACN,aAAa,CAACO,QAAQ,CAACJ,IAAI,CAACK,IAAI,CAAC,CAAE,CACtC,MAAO,CAAEH,GAAG,CAAE,EAAE,CAAEC,KAAK,CAAE,yCAA0C,CAAC,CACtE,CAEA;AACA,KAAM,CAAAG,QAAQ,CAAGV,WAAW,CAAG,IAAI,CAAG,IAAI,CAC1C,GAAII,IAAI,CAACO,IAAI,CAAGD,QAAQ,CAAE,CACxB,MAAO,CAAEJ,GAAG,CAAE,EAAE,CAAEC,KAAK,CAAE,oBAAoBP,WAAW,KAAM,CAAC,CACjE,CAEA,KAAM,CAAAY,SAAS,CAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CAC5B,KAAM,CAAAC,QAAQ,CAAG,GAAGV,WAAW,IAAIO,SAAS,IAAIR,IAAI,CAACY,IAAI,EAAE,CAE3D,KAAM,CAAEC,IAAI,CAAEV,KAAM,CAAC,CAAG,KAAM,CAAAR,QAAQ,CAACmB,OAAO,CAC3CC,IAAI,CAAC,WAAW,CAAC,CACjBhB,MAAM,CAACY,QAAQ,CAAEX,IAAI,CAAE,CACtBgB,YAAY,CAAE,MAAM,CACpBC,MAAM,CAAE,IACV,CAAC,CAAC,CAEJ,GAAId,KAAK,CAAE,CACTe,OAAO,CAACf,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAC/C,MAAO,CAAED,GAAG,CAAE,EAAE,CAAEC,KAAK,CAAE,2BAA4B,CAAC,CACxD,CAEA,KAAM,CAAEU,IAAI,CAAEM,aAAc,CAAC,CAAGxB,QAAQ,CACrCmB,OAAO,CACPC,IAAI,CAAC,WAAW,CAAC,CACjBK,YAAY,CAACT,QAAQ,CAAC,CAEzB,MAAO,CAAET,GAAG,CAAE,CAAAiB,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAEE,SAAS,GAAI,EAAE,CAAElB,KAAK,CAAE,IAAK,CAAC,CAC7D,CAAC,CAED,MAAO,CAAEJ,MAAO,CAAC,CACnB,CAAC,CAED,cAAe,CAAAD,iBAAiB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}