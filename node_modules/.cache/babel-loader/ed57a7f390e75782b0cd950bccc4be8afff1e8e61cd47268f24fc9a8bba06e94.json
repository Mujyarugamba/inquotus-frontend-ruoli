{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\151702\\\\Desktop\\\\Inquotus\\\\Inquotus-frontend-ruoli\\\\src\\\\components\\\\SalvaButton.jsx\",\n  _s = $RefreshSig$();\nimport { Star, StarOff } from 'lucide-react';\nimport React, { useEffect, useState } from 'react';\nimport { toast } from 'react-toastify';\nimport { supabase } from '../config/supabaseClient';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SalvaButton = ({\n  richiestaId,\n  userId\n}) => {\n  _s();\n  const [salvata, setSalvata] = useState(false);\n  const [salvataggioId, setSalvataggioId] = useState(null);\n  useEffect(() => {\n    const checkSalvata = async () => {\n      const {\n        data,\n        error\n      } = await supabase.from('richieste_salvate').select('id').eq('richiesta_id', richiestaId).eq('utente_id', userId).single();\n      if (data) {\n        setSalvata(true);\n        setSalvataggioId(data.id);\n      } else {\n        setSalvata(false);\n        setSalvataggioId(null);\n      }\n    };\n    if (userId && richiestaId) checkSalvata();\n  }, [userId, richiestaId]);\n  const toggleSalvataggio = async () => {\n    if (salvata && salvataggioId) {\n      const {\n        error\n      } = await supabase.from('richieste_salvate').delete().eq('id', salvataggioId);\n      if (!error) {\n        setSalvata(false);\n        setSalvataggioId(null);\n        toast.info('Richiesta rimossa dai salvati.');\n      } else {\n        console.error(error);\n        toast.error('Errore nella rimozione.');\n      }\n    } else {\n      const {\n        data,\n        error\n      } = await supabase.from('richieste_salvate').insert([{\n        richiesta_id: richiestaId,\n        utente_id: userId\n      }]);\n      if (!error) {\n        var _data$;\n        setSalvata(true);\n        setSalvataggioId((data === null || data === void 0 ? void 0 : (_data$ = data[0]) === null || _data$ === void 0 ? void 0 : _data$.id) || null);\n        toast.success('Richiesta salvata!');\n      } else {\n        console.error(error);\n        toast.error('Errore nel salvataggio.');\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    onClick: toggleSalvataggio,\n    className: `flex items-center gap-1 border px-2 py-1 rounded text-sm transition-all ${salvata ? 'bg-yellow-100 border-yellow-500 text-yellow-700' : 'bg-gray-100 border-gray-300 text-gray-600'}`,\n    children: [salvata ? /*#__PURE__*/_jsxDEV(Star, {\n      size: 16,\n      fill: \"gold\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 18\n    }, this) : /*#__PURE__*/_jsxDEV(StarOff, {\n      size: 16\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 51\n    }, this), salvata ? 'Salvata' : 'Salva']\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, this);\n};\n_s(SalvaButton, \"AokeZ1pjfR9qyfIA/NjCjueeAHs=\");\n_c = SalvaButton;\nexport default SalvaButton;\nvar _c;\n$RefreshReg$(_c, \"SalvaButton\");","map":{"version":3,"names":["Star","StarOff","React","useEffect","useState","toast","supabase","jsxDEV","_jsxDEV","SalvaButton","richiestaId","userId","_s","salvata","setSalvata","salvataggioId","setSalvataggioId","checkSalvata","data","error","from","select","eq","single","id","toggleSalvataggio","delete","info","console","insert","richiesta_id","utente_id","_data$","success","onClick","className","children","size","fill","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/151702/Desktop/Inquotus/Inquotus-frontend-ruoli/src/components/SalvaButton.jsx"],"sourcesContent":["import { Star, StarOff } from 'lucide-react';\nimport React, { useEffect, useState } from 'react';\nimport { toast } from 'react-toastify';\nimport { supabase } from '../config/supabaseClient';\n\nconst SalvaButton = ({ richiestaId, userId }) => {\n  const [salvata, setSalvata] = useState(false);\n  const [salvataggioId, setSalvataggioId] = useState(null);\n\n  useEffect(() => {\n    const checkSalvata = async () => {\n      const { data, error } = await supabase\n        .from('richieste_salvate')\n        .select('id')\n        .eq('richiesta_id', richiestaId)\n        .eq('utente_id', userId)\n        .single();\n\n      if (data) {\n        setSalvata(true);\n        setSalvataggioId(data.id);\n      } else {\n        setSalvata(false);\n        setSalvataggioId(null);\n      }\n    };\n\n    if (userId && richiestaId) checkSalvata();\n  }, [userId, richiestaId]);\n\n  const toggleSalvataggio = async () => {\n    if (salvata && salvataggioId) {\n      const { error } = await supabase\n        .from('richieste_salvate')\n        .delete()\n        .eq('id', salvataggioId);\n\n      if (!error) {\n        setSalvata(false);\n        setSalvataggioId(null);\n        toast.info('Richiesta rimossa dai salvati.');\n      } else {\n        console.error(error);\n        toast.error('Errore nella rimozione.');\n      }\n    } else {\n      const { data, error } = await supabase\n        .from('richieste_salvate')\n        .insert([{ richiesta_id: richiestaId, utente_id: userId }]);\n\n      if (!error) {\n        setSalvata(true);\n        setSalvataggioId(data?.[0]?.id || null);\n        toast.success('Richiesta salvata!');\n      } else {\n        console.error(error);\n        toast.error('Errore nel salvataggio.');\n      }\n    }\n  };\n\n  return (\n    <button\n      onClick={toggleSalvataggio}\n      className={`flex items-center gap-1 border px-2 py-1 rounded text-sm transition-all ${\n        salvata ? 'bg-yellow-100 border-yellow-500 text-yellow-700' : 'bg-gray-100 border-gray-300 text-gray-600'\n      }`}\n    >\n      {salvata ? <Star size={16} fill=\"gold\" /> : <StarOff size={16} />}\n      {salvata ? 'Salvata' : 'Salva'}\n    </button>\n  );\n};\n\nexport default SalvaButton;\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}