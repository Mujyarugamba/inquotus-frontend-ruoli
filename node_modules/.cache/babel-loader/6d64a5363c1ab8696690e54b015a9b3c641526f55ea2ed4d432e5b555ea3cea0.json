{"ast":null,"code":"import{Star,StarOff}from'lucide-react';import React,{useEffect,useState}from'react';import{toast}from'react-toastify';import{supabase}from'../config/supabaseClient';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SalvaButton=_ref=>{let{richiestaId,userId}=_ref;const[salvata,setSalvata]=useState(false);const[salvataggioId,setSalvataggioId]=useState(null);useEffect(()=>{const checkSalvata=async()=>{const{data,error}=await supabase.from('richieste_salvate').select('id').eq('richiesta_id',richiestaId).eq('utente_id',userId).single();if(data){setSalvata(true);setSalvataggioId(data.id);}else{setSalvata(false);setSalvataggioId(null);}};if(userId&&richiestaId)checkSalvata();},[userId,richiestaId]);const toggleSalvataggio=async()=>{if(salvata&&salvataggioId){const{error}=await supabase.from('richieste_salvate').delete().eq('id',salvataggioId);if(!error){setSalvata(false);setSalvataggioId(null);toast.info('Richiesta rimossa dai salvati.');}else{console.error(error);toast.error('Errore nella rimozione.');}}else{const{data,error}=await supabase.from('richieste_salvate').insert([{richiesta_id:richiestaId,utente_id:userId}]);if(!error){var _data$;setSalvata(true);setSalvataggioId((data===null||data===void 0?void 0:(_data$=data[0])===null||_data$===void 0?void 0:_data$.id)||null);toast.success('Richiesta salvata!');}else{console.error(error);toast.error('Errore nel salvataggio.');}}};return/*#__PURE__*/_jsxs(\"button\",{onClick:toggleSalvataggio,className:`flex items-center gap-1 border px-2 py-1 rounded text-sm transition-all ${salvata?'bg-yellow-100 border-yellow-500 text-yellow-700':'bg-gray-100 border-gray-300 text-gray-600'}`,children:[salvata?/*#__PURE__*/_jsx(Star,{size:16,fill:\"gold\"}):/*#__PURE__*/_jsx(StarOff,{size:16}),salvata?'Salvata':'Salva']});};export default SalvaButton;","map":{"version":3,"names":["Star","StarOff","React","useEffect","useState","toast","supabase","jsx","_jsx","jsxs","_jsxs","SalvaButton","_ref","richiestaId","userId","salvata","setSalvata","salvataggioId","setSalvataggioId","checkSalvata","data","error","from","select","eq","single","id","toggleSalvataggio","delete","info","console","insert","richiesta_id","utente_id","_data$","success","onClick","className","children","size","fill"],"sources":["C:/Users/151702/Desktop/Inquotus/Inquotus-frontend-ruoli/src/components/SalvaButton.jsx"],"sourcesContent":["import { Star, StarOff } from 'lucide-react';\nimport React, { useEffect, useState } from 'react';\nimport { toast } from 'react-toastify';\nimport { supabase } from '../config/supabaseClient';\n\nconst SalvaButton = ({ richiestaId, userId }) => {\n  const [salvata, setSalvata] = useState(false);\n  const [salvataggioId, setSalvataggioId] = useState(null);\n\n  useEffect(() => {\n    const checkSalvata = async () => {\n      const { data, error } = await supabase\n        .from('richieste_salvate')\n        .select('id')\n        .eq('richiesta_id', richiestaId)\n        .eq('utente_id', userId)\n        .single();\n\n      if (data) {\n        setSalvata(true);\n        setSalvataggioId(data.id);\n      } else {\n        setSalvata(false);\n        setSalvataggioId(null);\n      }\n    };\n\n    if (userId && richiestaId) checkSalvata();\n  }, [userId, richiestaId]);\n\n  const toggleSalvataggio = async () => {\n    if (salvata && salvataggioId) {\n      const { error } = await supabase\n        .from('richieste_salvate')\n        .delete()\n        .eq('id', salvataggioId);\n\n      if (!error) {\n        setSalvata(false);\n        setSalvataggioId(null);\n        toast.info('Richiesta rimossa dai salvati.');\n      } else {\n        console.error(error);\n        toast.error('Errore nella rimozione.');\n      }\n    } else {\n      const { data, error } = await supabase\n        .from('richieste_salvate')\n        .insert([{ richiesta_id: richiestaId, utente_id: userId }]);\n\n      if (!error) {\n        setSalvata(true);\n        setSalvataggioId(data?.[0]?.id || null);\n        toast.success('Richiesta salvata!');\n      } else {\n        console.error(error);\n        toast.error('Errore nel salvataggio.');\n      }\n    }\n  };\n\n  return (\n    <button\n      onClick={toggleSalvataggio}\n      className={`flex items-center gap-1 border px-2 py-1 rounded text-sm transition-all ${\n        salvata ? 'bg-yellow-100 border-yellow-500 text-yellow-700' : 'bg-gray-100 border-gray-300 text-gray-600'\n      }`}\n    >\n      {salvata ? <Star size={16} fill=\"gold\" /> : <StarOff size={16} />}\n      {salvata ? 'Salvata' : 'Salva'}\n    </button>\n  );\n};\n\nexport default SalvaButton;\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}