{"ast":null,"code":"import React,{useEffect,useState}from'react';import{createClient}from'@supabase/supabase-js';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const supabase=createClient(process.env.REACT_APP_SUPABASE_URL,process.env.REACT_APP_SUPABASE_ANON_KEY);const AdminNotifiche=()=>{const[notifiche,setNotifiche]=useState([]);const[nonLette,setNonLette]=useState(0);useEffect(()=>{const fetchIniziali=async()=>{const{data,error}=await supabase.from('notifiche').select('*').order('timestamp',{ascending:false}).limit(20);if(!error){setNotifiche(data);setNonLette(data.filter(n=>!n.letto).length);}};fetchIniziali();const channel=supabase.channel('notifiche-admin').on('postgres_changes',{event:'*',schema:'public',table:'notifiche'},payload=>{setNotifiche(prev=>[payload.new,...prev]);if(!payload.new.letto){setNonLette(prev=>prev+1);}}).subscribe();return()=>supabase.removeChannel(channel);},[]);return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'1rem'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDD14 Notifiche in tempo reale (Admin)\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Non lette:\"}),\" \",nonLette]}),/*#__PURE__*/_jsx(\"ul\",{children:notifiche.map((n,i)=>/*#__PURE__*/_jsxs(\"li\",{style:{marginBottom:'1rem',borderBottom:'1px solid #ccc'},children:[/*#__PURE__*/_jsx(\"strong\",{children:n.tipo}),\" da \",/*#__PURE__*/_jsx(\"em\",{children:n.email_utente}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{children:new Date(n.timestamp).toLocaleString()}),' ',!n.letto&&/*#__PURE__*/_jsx(\"span\",{style:{color:'red'},children:\"\\uD83C\\uDD95\"})]},i))})]});};export default AdminNotifiche;","map":{"version":3,"names":["React","useEffect","useState","createClient","jsx","_jsx","jsxs","_jsxs","supabase","process","env","REACT_APP_SUPABASE_URL","REACT_APP_SUPABASE_ANON_KEY","AdminNotifiche","notifiche","setNotifiche","nonLette","setNonLette","fetchIniziali","data","error","from","select","order","ascending","limit","filter","n","letto","length","channel","on","event","schema","table","payload","prev","new","subscribe","removeChannel","style","padding","children","map","i","marginBottom","borderBottom","tipo","email_utente","Date","timestamp","toLocaleString","color"],"sources":["C:/Users/151702/Desktop/Inquotus/Inquotus-frontend-ruoli/src/admin/AdminNotifiche.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { createClient } from '@supabase/supabase-js';\n\nconst supabase = createClient(\n  process.env.REACT_APP_SUPABASE_URL,\n  process.env.REACT_APP_SUPABASE_ANON_KEY\n);\n\nconst AdminNotifiche = () => {\n  const [notifiche, setNotifiche] = useState([]);\n  const [nonLette, setNonLette] = useState(0);\n\n  useEffect(() => {\n    const fetchIniziali = async () => {\n      const { data, error } = await supabase\n        .from('notifiche')\n        .select('*')\n        .order('timestamp', { ascending: false })\n        .limit(20);\n\n      if (!error) {\n        setNotifiche(data);\n        setNonLette(data.filter(n => !n.letto).length);\n      }\n    };\n\n    fetchIniziali();\n\n    const channel = supabase\n      .channel('notifiche-admin')\n      .on('postgres_changes', { event: '*', schema: 'public', table: 'notifiche' }, payload => {\n        setNotifiche(prev => [payload.new, ...prev]);\n        if (!payload.new.letto) {\n          setNonLette(prev => prev + 1);\n        }\n      })\n      .subscribe();\n\n    return () => supabase.removeChannel(channel);\n  }, []);\n\n  return (\n    <div style={{ padding: '1rem' }}>\n      <h2>ðŸ”” Notifiche in tempo reale (Admin)</h2>\n      <p><strong>Non lette:</strong> {nonLette}</p>\n\n      <ul>\n        {notifiche.map((n, i) => (\n          <li key={i} style={{ marginBottom: '1rem', borderBottom: '1px solid #ccc' }}>\n            <strong>{n.tipo}</strong> da <em>{n.email_utente}</em><br />\n            <small>{new Date(n.timestamp).toLocaleString()}</small>{' '}\n            {!n.letto && <span style={{ color: 'red' }}>ðŸ†•</span>}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n\nexport default AdminNotifiche;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}